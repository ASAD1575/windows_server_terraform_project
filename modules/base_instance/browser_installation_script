This script installs browsers using winget and sets them to run on startup.
Define the paths to the browsers to be installed
$browsers = @(
"Google.Chrome",
"Mozilla.Firefox",
"Microsoft.Edge"
)

Install browsers using winget, ensuring progress is shown and agreements are accepted.
foreach ($browser in $browsers) {
Write-Output "Installing $browser..."
winget install --id $browser -e --accept-package-agreements --silent-with-progress
}

Define the paths to the installed browser executables
$browserExecutables = @(
"C:\Program Files\Google\Chrome\Application\chrome.exe",
"C:\Program Files\Mozilla Firefox\firefox.exe",
"C:\Program Files (x86)\Microsoft\Edge\Application\msedge.exe"
)

Create a scheduled task to launch the browsers at system startup.
This ensures they open automatically as soon as the instance is ready.
Write-Output "Creating scheduled task to run browsers on startup..."
$action = New-ScheduledTaskAction -Execute "powershell.exe" -Argument "-Command "$browserExecutables | ForEach-Object { Start-Process -FilePath \$_ }`""
$trigger = New-ScheduledTaskTrigger -AtStartup
Register-ScheduledTask -TaskName "LaunchBrowsersOnStartup" -Action $action -Trigger $trigger -Description "Launches Chrome, Firefox, and Edge automatically on system startup." -User "SYSTEM"

Write-Output "Browser installation and scheduled task creation complete."